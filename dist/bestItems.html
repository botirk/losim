<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>simulateBestItems.html</title></head><body> <label for="question" id="question" style="white-space:pre-line"></label> <br> <input name="question" type="text" autofocus> <script type="module">var t,e,i,a,s=globalThis;function n(t){return t&&t.__esModule?t.default:t}var o={},r={},c=s.parcelRequireab82;null==c&&((c=function(t){if(t in o)return o[t].exports;if(t in r){var e=r[t];delete r[t];var i={id:t,exports:{}};return o[t]=i,e.call(i.exports,i,i.exports),i.exports}var a=Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,e){r[t]=e},s.parcelRequireab82=c);var h=c.register;h("cmoHh",function(t,e){!function(t,e,i){function a(t){var e,i=this,a=(e=4022871197,function(t){t=String(t);for(var i=0;i<t.length;i++){var a=.02519603282416938*(e+=t.charCodeAt(i));e=a>>>0,a-=e,a*=e,e=a>>>0,a-=e,e+=4294967296*a}return(e>>>0)*23283064365386963e-26});i.next=function(){var t=2091639*i.s0+23283064365386963e-26*i.c;return i.s0=i.s1,i.s1=i.s2,i.s2=t-(i.c=0|t)},i.c=1,i.s0=a(" "),i.s1=a(" "),i.s2=a(" "),i.s0-=a(t),i.s0<0&&(i.s0+=1),i.s1-=a(t),i.s1<0&&(i.s1+=1),i.s2-=a(t),i.s2<0&&(i.s2+=1)}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function n(t,e){var i=new a(t),n=e&&e.state,o=i.next;return o.int32=function(){return 4294967296*i.next()|0},o.double=function(){return o()+(2097152*o()|0)*11102230246251565e-32},o.quick=o,n&&("object"==typeof n&&s(n,i),o.state=function(){return s(i,{})}),o}e&&e.exports?e.exports=n:i&&i.amd?i(function(){return n}):this.alea=n}(0,t,"function"==typeof define&&define)}),h("euRi5",function(t,e){!function(t,e,i){function a(t){var e=this,i="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:i+=t;for(var a=0;a<i.length+64;a++)e.x^=0|i.charCodeAt(a),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function n(t,e){var i=new a(t),n=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do var t=i.next()>>>11,e=(i.next()>>>0)/4294967296,a=(t+e)/2097152;while(0===a)return a},o.int32=i.next,o.quick=o,n&&("object"==typeof n&&s(n,i),o.state=function(){return s(i,{})}),o}e&&e.exports?e.exports=n:i&&i.amd?i(function(){return n}):this.xor128=n}(0,t,"function"==typeof define&&define)}),h("hDsEw",function(t,e){!function(t,e,i){function a(t){var e=this,i="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^(t^t<<1))|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:i+=t;for(var a=0;a<i.length+64;a++)e.x^=0|i.charCodeAt(a),a==i.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function n(t,e){var i=new a(t),n=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do var t=i.next()>>>11,e=(i.next()>>>0)/4294967296,a=(t+e)/2097152;while(0===a)return a},o.int32=i.next,o.quick=o,n&&("object"==typeof n&&s(n,i),o.state=function(){return s(i,{})}),o}e&&e.exports?e.exports=n:i&&i.amd?i(function(){return n}):this.xorwow=n}(0,t,"function"==typeof define&&define)}),h("3J2Zm",function(t,e){!function(t,e,i){function a(t){var e=this;e.next=function(){var t,i,a=e.x,s=e.i;return t=a[s],t^=t>>>7,i=t^t<<24^((t=a[s+1&7])^t>>>10)^((t=a[s+3&7])^t>>>3)^((t=a[s+4&7])^t<<7),t=a[s+7&7],t^=t<<13,i^=t^t<<9,a[s]=i,e.i=s+1&7,i},function(t,e){var i,a=[];if(e===(0|e))a[0]=e;else for(i=0,e=""+e;i<e.length;++i)a[7&i]=a[7&i]<<15^e.charCodeAt(i)+a[i+1&7]<<13;for(;a.length<8;)a.push(0);for(i=0;i<8&&0===a[i];++i);for(8==i?a[7]=-1:a[i],t.x=a,t.i=0,i=256;i>0;--i)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function n(t,e){null==t&&(t=+new Date);var i=new a(t),n=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do var t=i.next()>>>11,e=(i.next()>>>0)/4294967296,a=(t+e)/2097152;while(0===a)return a},o.int32=i.next,o.quick=o,n&&(n.x&&s(n,i),o.state=function(){return s(i,{})}),o}e&&e.exports?e.exports=n:i&&i.amd?i(function(){return n}):this.xorshift7=n}(0,t,"function"==typeof define&&define)}),h("6Px8M",function(t,e){!function(t,e,i){function a(t){var e=this;e.next=function(){var t,i,a=e.w,s=e.X,n=e.i;return e.w=a=a+1640531527|0,i=s[n+34&127],t=s[n=n+1&127],i^=i<<13,t^=t<<17,i^=i>>>15,t^=t>>>12,i=s[n]=i^t,e.i=n,i+(a^a>>>16)|0},function(t,e){var i,a,s,n,o,r=[],c=128;for(e===(0|e)?(a=e,e=null):(e+="\0",a=0,c=Math.max(c,e.length)),s=0,n=-32;n<c;++n)e&&(a^=e.charCodeAt((n+32)%e.length)),0===n&&(o=a),a^=a<<10,a^=a>>>15,a^=a<<4,a^=a>>>13,n>=0&&(o=o+1640531527|0,s=0==(i=r[127&n]^=a+o)?s+1:0);for(s>=128&&(r[127&(e&&e.length||0)]=-1),s=127,n=512;n>0;--n)a=r[s+34&127],i=r[s=s+1&127],a^=a<<13,i^=i<<17,a^=a>>>15,i^=i>>>12,r[s]=a^i;t.w=o,t.X=r,t.i=s}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function n(t,e){null==t&&(t=+new Date);var i=new a(t),n=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do var t=i.next()>>>11,e=(i.next()>>>0)/4294967296,a=(t+e)/2097152;while(0===a)return a},o.int32=i.next,o.quick=o,n&&(n.X&&s(n,i),o.state=function(){return s(i,{})}),o}e&&e.exports?e.exports=n:i&&i.amd?i(function(){return n}):this.xor4096=n}(0,t,"function"==typeof define&&define)}),h("lDm0S",function(t,e){!function(t,e,i){function a(t){var e=this,i="";e.next=function(){var t=e.b,i=e.c,a=e.d,s=e.a;return t=t<<25^t>>>7^i,i=i-a|0,a=a<<24^a>>>8^s,s=s-t|0,e.b=t=t<<20^t>>>12^i,e.c=i=i-a|0,e.d=a<<16^i>>>16^s,e.a=s-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):i+=t;for(var a=0;a<i.length+20;a++)e.b^=0|i.charCodeAt(a),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function n(t,e){var i=new a(t),n=e&&e.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do var t=i.next()>>>11,e=(i.next()>>>0)/4294967296,a=(t+e)/2097152;while(0===a)return a},o.int32=i.next,o.quick=o,n&&("object"==typeof n&&s(n,i),o.state=function(){return s(i,{})}),o}e&&e.exports?e.exports=n:i&&i.amd?i(function(){return n}):this.tychei=n}(0,t,"function"==typeof define&&define)}),h("kjyEk",function(t,e){}),h("jGbML",function(t,e){var i=c("hJ3nf");!function(t,e){if(!t.setImmediate){var a,s,n,o,r,c=1,h={},l=!1,u=t.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(t);m=m&&m.setTimeout?m:t,"[object process]"===({}).toString.call(t.process)?r=function(t){i.nextTick(function(){p(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}):t.MessageChannel?((n=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){n.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(o=u.documentElement,r=function(t){var e=u.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):r=function(t){setTimeout(p,0,t)},m.setImmediate=function(t){"function"!=typeof t&&(t=Function(""+t));for(var e=Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var a={callback:t,args:e};return h[c]=a,r(c),c++},m.clearImmediate=d}function d(t){delete h[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=h[t];if(e){l=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(void 0,i)}}(e)}finally{d(t),l=!1}}}}}("undefined"==typeof self?void 0===s?t.exports:s:self)}),h("hJ3nf",function(t,e){t.exports={}});class l{constructor(t){this._value=t,this._callbacks=[]}set value(t){if(this._value===t)return;let e=this._value;for(let i of(this._value=t,this._callbacks))i(e,t)}get value(){return this._value}callback(t){return this._callbacks.push(t),()=>{let e=this._callbacks.indexOf(t);-1!==e&&this._callbacks.splice(e,1)}}promise(t,e){return new Promise(i=>{let a=this.callback((t,s)=>{(void 0===e||e===s||"function"==typeof e&&e(t,s))&&(a(),i([t,s]))});t.then(()=>a())})}}(t=i||(i={}))[t.TRUE=0]="TRUE",t[t.PHYSIC=1]="PHYSIC",t[t.MAGIC=2]="MAGIC";class u{constructor(t){this.unit=t,this._onTakeDamage=[],this._percentDamageReduction=[],this._flatDamageReduction=[],this._finalDamageReduction=[],this._onKill=[],this._takedownTimes=new Map,this._onTakedown=[]}takeHeal(t){!0!==this.unit.dead.value&&(t.value=Math.max(0,Math.min(this.unit.maxHealth,t.value)),this.unit.health+=t.value)}takeDamage(t){if(!0===this.unit.dead.value)return{...t,value:0};for(let e of(this.calcDamageReduction(t),t.value=Math.max(0,Math.min(this.unit.health,t.value)),this.unit.health=Math.max(0,this.unit.health-t.value),this._onTakeDamage))e(t);if(this._takedownTimes.set(t.src,this.unit.sim.time),0===this.unit.health)for(let e of(this.unit.dead.value=!0,t.src.interaction.kill(this.unit),this._takedownTimes))e[0].interaction.takedown(this.unit,e[1]),this._takedownTimes.delete(e[0]);return t}onTakeDamage(t){return this._onTakeDamage.push(t),()=>{let e=this._onTakeDamage.indexOf(t);-1!==e&&this._onTakeDamage.splice(e,1)}}percentDamageReduction(t){return this._percentDamageReduction.push(t),()=>{let e=this._percentDamageReduction.indexOf(t);-1!==e&&this._percentDamageReduction.splice(e,1)}}calcArmorDamageReduction(t){return 1===t.type&&(t.value=(1-this.unit.armor/(100+this.unit.armor))*t.value),t}calcMrDamageReduction(t){return 2===t.type&&(t.value=(1-this.unit.mr/(100+this.unit.mr))*t.value),t}flatDamageReduction(t){return this._flatDamageReduction.push(t),()=>{let e=this._flatDamageReduction.indexOf(t);-1!==e&&this._flatDamageReduction.splice(e,1)}}finalDamageReduction(t){return this._finalDamageReduction.push(t),()=>{let e=this._finalDamageReduction.indexOf(t);-1!==e&&this._finalDamageReduction.splice(e,1)}}calcDamageReduction(t){for(let e of this._flatDamageReduction)e(t);for(let e of this._percentDamageReduction)e(t);for(let e of this._finalDamageReduction)e(t);return t}onKill(t){return this._onKill.push(t),()=>{let e=this._onKill.indexOf(t);-1!==e&&this._onKill.splice(e,1)}}kill(t){for(let e of this._onKill)e(t)}onTakedown(t){return this._onTakedown.push(t),()=>{let e=this._onTakedown.indexOf(t);-1!==e&&this._onTakedown.splice(e,1)}}takedown(t,e){for(let i of this._onTakedown)i(t,e)}init(){return this.percentDamageReduction(t=>this.calcArmorDamageReduction(t)),this.percentDamageReduction(t=>this.calcMrDamageReduction(t)),this}}class m{constructor(t,e){this.name=t,this.owner=e,this._level=0,this.abilityHaste=0,this._onCast=[]}levelUp(){if(this.level>=this.maxLevel)return!1;if(this.isUltimate){if(this.owner.level<6||this.owner.level<11&&this.level>=1||this.owner.level<16&&this.level>=2)return!1}else if(this.level>=Math.ceil(this.owner.level/2))return!1;return this.level+=1,!0}get manaCost(){return 0}get level(){return this._level}set level(t){this._level=Math.max(0,Math.min(this.maxLevel,t))}startCooldown(){this.isCooldown||(this.cooldown=this.owner.sim.waitFor(this.cooldownTime))}get isCooldown(){return!!this.cooldown&&void 0===this.cooldown.result}async waitCooldown(){await this?.cooldown}get remainingCooldown(){return this.cooldown?.remainingTime||0}set remainingCooldown(t){this.cooldown&&(this.cooldown.remainingTime=t)}setCooldown(t){this.cooldown&&(this.cooldown.waitFor=t)}finishCooldown(){this.cooldown?.resolve(!0),this.cooldown=void 0}get abilityHasteModifier(){return 100/(100+this.abilityHaste)}castable(t){return this.level>=this.minLevel&&(!this.owner.currentCast.value||0===this.castTime)&&!this.isCooldown&&!this.owner.dead.value&&this.owner.mana>=this.manaCost}get currentCast(){if(this.owner.currentCast.value?.action===this)return this.owner.currentCast.value}onCast(t){return this._onCast.push(t),()=>{let e=this._onCast.indexOf(t);-1!==e&&this._onCast.splice(e,1)}}procOnCast(t){for(let e of this._onCast)e(t)}}class d extends m{onHitUnit(t){return this._onHitUnit.push(t),()=>{let e=this._onHitUnit.indexOf(t);-1!==e&&this._onHitUnit.splice(e,1)}}procOnHitUnit(t,e=1){for(let i of this._onHitUnit)i(t,e)}targetable(t){return t.targetable.value&&Math.abs(t.pos-this.owner.pos)<=this.maxRange&&this.owner.isEnemy(t)}castable(t){return super.castable(t)&&this.targetable(t)}constructor(...t){super(...t),this._onHitUnit=[]}}class p{constructor(t,e){this.action=t,this.option=e}get remaining(){return this.wheel?.remainingTime||0}set waitFor(t){this.wheel&&(this.wheel.waitFor=t)}get isCasting(){return!!this.wheel&&void 0===this.wheel.result}async wait(){return await this.wheel}async interrupt(){this.wheel?.resolve(!1),await this.action.owner.sim.waitFor(0)}async cancel(){if(!this.action.isCancelableByUser)throw Error(`${this.action.name}'s cast is not cancelable by user`);await this.interrupt()}async watchInterrupt(){}async onStartCast(){}async onFinishCast(){}async init(){if(this.action.currentCast)return this.action.currentCast.wait();if(!this.action.castable(this.option))return!1;if(this.action.owner.mana-=this.action.manaCost,this.action.castTime<=0)return this.action.startCooldown(),this.onStartCast(),this.onFinishCast(),this.action.procOnCast(this.option),!0;{this.wheel=this.action.owner.sim.waitFor(this.action.castTime),this.action.owner.currentCast.value=this,this.action.startCooldown(),this.watchInterrupt(),this.onStartCast();let t=await this.wheel;return t?(this.onFinishCast(),this.action.procOnCast(this.option)):this.action.isCooldownFinishedOnInterrupt&&this.action.finishCooldown(),t}}}class w extends p{constructor(...t){super(...t),this.watchInterrupt=async()=>{!1===await Promise.any([this.action.owner.dead.promise(this.wait()).then(()=>!1),this.wait()])&&this.interrupt()}}}class f extends p{constructor(...t){super(...t),this.watchInterrupt=async()=>{!1===await Promise.any([this.option.targetable.promise(this.wait(),!1).then(()=>!1),this.action.owner.dead.promise(this.wait(),!0).then(()=>!1),this.wait()])&&this.interrupt()}}}class v extends p{constructor(...t){super(...t),this.watchInterrupt=async()=>{!1===await Promise.any([this.action.owner.dead.promise(this.wait(),!0).then(()=>!1),this.wait()])&&this.interrupt()}}}var x={},g=c("cmoHh"),k=c("euRi5"),b=c("hDsEw"),y=c("3J2Zm"),C=c("6Px8M"),M=c("lDm0S"),T={};!function(t,e,i){var a,s="random",n=i.pow(256,6),o=i.pow(2,52),r=2*o;function h(c,h,p){var w=[],f=m(function t(e,i){var a,s=[],n=typeof e;if(i&&"object"==n)for(a in e)try{s.push(t(e[a],i-1))}catch(t){}return s.length?s:"string"==n?e:e+"\0"}((h=!0==h?{entropy:!0}:h||{}).entropy?[c,d(e)]:null==c?function(){try{var i;return a&&(i=a.randomBytes)?i=i(256):(i=new Uint8Array(256),(t.crypto||t.msCrypto).getRandomValues(i)),d(i)}catch(i){var s=t.navigator,n=s&&s.plugins;return[+new Date,t,n,t.screen,d(e)]}}():c,3),w),v=new l(w),x=function(){for(var t=v.g(6),e=n,i=0;t<o;)t=(t+i)*256,e*=256,i=v.g(1);for(;t>=r;)t/=2,e/=2,i>>>=1;return(t+i)/e};return x.int32=function(){return 0|v.g(4)},x.quick=function(){return v.g(4)/4294967296},x.double=x,m(d(v.S),e),(h.pass||p||function(t,e,a,n){return(n&&(n.S&&u(n,v),t.state=function(){return u(v,{})}),a)?(i[s]=t,e):t})(x,f,"global"in h?h.global:this==i,h.state)}function l(t){var e,i=t.length,a=this,s=0,n=a.i=a.j=0,o=a.S=[];for(i||(t=[i++]);s<256;)o[s]=s++;for(s=0;s<256;s++)o[s]=o[n=255&n+t[s%i]+(e=o[s])],o[n]=e;(a.g=function(t){for(var e,i=0,s=a.i,n=a.j,o=a.S;t--;)e=o[s=255&s+1],i=256*i+o[255&(o[s]=o[n=255&n+e])+(o[n]=e)];return a.i=s,a.j=n,i})(256)}function u(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var i,a=t+"",s=0;s<a.length;)e[255&s]=255&(i^=19*e[255&s])+a.charCodeAt(s++);return d(e)}function d(t){return String.fromCharCode.apply(0,t)}if(m(i.random(),e),T){T=h;try{a=c("kjyEk")}catch(t){}}else"function"==typeof define&&define.amd?define(function(){return h}):i["seed"+s]=h}("undefined"!=typeof self?self:T,[],Math),T.alea=g,T.xor128=k,T.xorwow=b,T.xorshift7=y,T.xor4096=C,T.tychei=M,x=T;class A extends d{constructor(t){super("Attack",t),this.minLevel=0,this.maxLevel=0,this.isCancelableByUser=!0,this.isCooldownFinishedOnInterrupt=!0,this.isUltimate=!1,this.random=n(x)(),t.bonusAs.callback(()=>{this.setCooldown(this.cooldownTime),this.currentCast&&(this.currentCast.waitFor=this.castTime)})}get maxRange(){return this.owner.attackRange}get castTime(){return 1/this.owner.as*this.owner.attackAnimation*1e3}get cooldownTime(){return 1/this.owner.as*1e3}castable(t){return!this.owner.dead.value&&t.targetable.value&&Math.abs(this.owner.pos-t.pos)<this.maxRange&&this.owner.isEnemy(t)}calc(t){return t.interaction.calcDamageReduction({value:this.owner.ad,src:this.owner,type:i.PHYSIC}).value}async cast(t){return await new B(this,t,this.random).init()}}class B extends f{constructor(t,e,i){super(t,e),this.random=i}async onFinishCast(){let t=Math.max(0,Math.min(100,this.action.owner.crit))>=100*this.random(),e=t?this.action.owner.ad*(1.75+this.action.owner.bonusCritDamage/100):this.action.owner.ad;this.action.procOnHitUnit(this.option);let a=this.option.interaction.takeDamage({value:e,src:this.action.owner,type:i.PHYSIC,isCrit:t});this.action.owner.lifesteal>0&&this.action.owner.interaction.takeHeal({src:this.action.owner,value:a.value*(this.action.owner.lifesteal/100)})}async init(){return this.action.currentCast?this.action.currentCast.wait():!!this.action.castable(this.option)&&(!this.action.isCooldown||!1!==await Promise.any([this.action.waitCooldown(),this.option.targetable.promise(this.action.waitCooldown(),!1).then(()=>!1),this.action.owner.dead.promise(this.action.waitCooldown(),!0).then(()=>!1),this.action.owner.currentCast.promise(this.action.waitCooldown(),t=>t!==this).then(()=>!1)]))&&await super.init()}}class S extends m{constructor(t){super("Move",t),this.minLevel=0,this.maxLevel=0,this.isCancelableByUser=!0,this.isCooldownFinishedOnInterrupt=!0,this.isUltimate=!1}get castTime(){return this.owner.sim.tickTime}get cooldownTime(){return 0}get value(){return this.owner.ms*(this.owner.sim.tickTime/1e3)}cast(t){return new D(this,t).init()}awayFrom(t){return t.pos<=this.owner.pos?this.cast(1/0):this.cast(-1/0)}closeTo(t){return this.cast(t.pos)}}class D extends v{async onFinishCast(){let t=this.option-this.action.owner.pos;t>=0?this.action.owner.pos+=Math.min(t,this.action.value):this.action.owner.pos+=Math.max(t,-this.action.value)}}class _{constructor(t){this.owner=t}init(){return this.attack=new A(this.owner),this.move=new S(this.owner),this}}class H extends l{constructor(t,e){super(t),this.unit=e,this._stacks=0,e.dead.callback(()=>super.value=this.value)}get value(){return!this.unit.dead.value&&this._stacks<=0}set value(t){t?this._stacks=Math.max(0,this._stacks-1):this._stacks+=1,super.value=this.value}}class E extends l{constructor(t){super(t)}get value(){if(super.value?.isCasting)return super.value}set value(t){super.value=t}}class q{constructor(t){this.name=t,this.level=1,this.health=0,this.maxHealth=0,this.mana=0,this.maxMana=0,this.armor=0,this.mr=0,this.team="DEATHMATCH",this.pos=0,this.baseMs=0,this.bonusMs=0,this.mMs=1,this.abilityHaste=0,this.attackRange=175,this.attackAnimation=.4,this.baseAd=0,this.bonusAd=0,this.lifesteal=0,this.crit=0,this.bonusCritDamage=0,this.baseAs=0,this.bonusAs=new l(0),this.dead=new l(!1),this.targetable=new H(!0,this),this.buffs=[],this._itemCount=0,this.appliedEquips=[],this.currentCast=new E(void 0)}isEnemy(t){return t!==this&&"DEATHMATCH"===this.team||"DEATHMATCH"===t.team||t.team!==this.team}distance(t){return Math.abs(this.pos-t.pos)}get ms(){let t=(this.baseMs+this.bonusMs)*this.mMs*((100-this.slow)/100);return t<=0?t=110:t<220?t=110+.5*t:t>415&&t<490?t=.8*t+83:t>490&&(t=.5*t+230),t}get slow(){return this.buffs.reduce((t,e)=>e.slow>t?e.slow:t,0)}get abilityHasteModifier(){return 100/(100+this.abilityHaste)}get ad(){return this.baseAd+this.bonusAd}get as(){return this.baseAs*(1+this.bonusAs.value/100)}buffsNamed(t){return this.buffs.filter(e=>e.name===t)}buffNamed(t){return this.buffs.find(e=>e.name===t)}get itemCount(){return this._itemCount}applyEquip(t){if(t.unique&&this.appliedEquips.includes(t)||t.uniqueGroup&&this.appliedEquips.some(e=>e.uniqueGroup===t.uniqueGroup))return!1;if("item"===t.type||"finishedItem"===t.type){if(this._itemCount>=6)return!1;this._itemCount+=1}return t.apply?.(this)!==!1&&(t.bonusAs&&(this.bonusAs.value+=t.bonusAs),t.bonusAd&&(this.bonusAd+=t.bonusAd),t.crit&&(this.crit=Math.max(0,Math.min(100,this.crit+t.crit))),t.bonusCritDamage&&(this.bonusCritDamage+=t.bonusCritDamage),t.lifesteal&&(this.lifesteal+=t.lifesteal),t.armor&&(this.armor+=t.armor),t.mr&&(this.mr+=t.mr),t.maxHealth&&(this.maxHealth+=t.maxHealth,this.health=Math.min(this.maxHealth,this.health+t.maxHealth)),t.maxMana&&(this.maxMana+=t.maxMana),t.bonusMs&&(this.bonusMs+=t.bonusMs),t.mMs&&(this.mMs*=t.mMs),t.abilityHaste&&(this.abilityHaste+=t.abilityHaste),this.appliedEquips.push(t),!0)}async runAwayFromEnemyAsDummy(t){await this.action.move.awayFrom(t)}async killDummy(t){!(this.action.attack.currentCast&&await this.action.attack.currentCast.wait())&&(this.action.attack.isCooldown&&await this.action.move.closeTo(t)||await this.action.attack.cast(t)||await this.action.move.closeTo(t))}init(t,e=this.team,i=this.level){if(this.interaction||(this.interaction=new u(this).init()),this.sim){let t=this.sim.units.indexOf(this);-1!==t&&this.sim.units.splice(t,1)}return this.sim=t,t&&this.sim.units.push(this),this.team=e,this.level=i,this.dead.value=!1,this}}const U=new class extends q{constructor(){super("GodUnit"),this.isMelee=!0}}().init();class F extends q{levelUpAnyChampion(t,e,i,a){for(let s=this.level;s>0;s-=1){let s,n,o,r;switch(this.levelUpPriority[0]){case"Q":s=t;break;case"W":s=e;break;case"E":s=i;break;default:s=a}switch(this.levelUpPriority[1]){case"Q":n=t;break;case"W":n=e;break;case"E":n=i;break;default:n=a}switch(this.levelUpPriority[2]){case"Q":o=t;break;case"W":o=e;break;case"E":o=i;break;default:o=a}switch(this.levelUpPriority[3]){case"Q":r=t;break;case"W":r=e;break;case"E":r=i;break;default:r=a}!(s.level>=s.minLevel&&(n.minLevel<n.minLevel&&n.levelUp()||n.level>=n.minLevel&&(o.minLevel<o.minLevel&&o.levelUp()||o.level>=o.minLevel&&r.level<r.minLevel&&r.levelUp())))&&(s.levelUp()||n.levelUp()||o.levelUp()||r.levelUp())}}calcStatGrowth(t){return t*(this.level-1)*(.7025+.0175*(this.level-1))}init(t,e=this.team,i=this.level){return super.init(t,e,i),this.maxHealth=this.stats.baseHealth+this.calcStatGrowth(this.stats.healthGrowth),this.health=this.maxHealth,this.baseAd=this.stats.baseAd,this.bonusAd=this.calcStatGrowth(this.stats.adGrowth),this.attackRange=this.stats.attackRange,this.armor=this.stats.baseArmor+this.calcStatGrowth(this.stats.armorGrowth),this.attackAnimation=this.stats.attackAnimation,this.baseAs=this.stats.baseAs,this.bonusAs.value=this.calcStatGrowth(this.stats.asGrowth),this.baseMs=this.stats.baseMs,this.mana=this.stats.baseMana+this.calcStatGrowth(this.stats.manaGrowth),this.maxMana=this.mana,this}}const R={baseMs:355,baseAs:.679,asGrowth:2,baseHealth:669,healthGrowth:100,baseMana:251,manaGrowth:42,attackAnimation:.24375,attackRange:175,baseAd:65,adGrowth:2.2,baseArmor:33,armorGrowth:4.2};class I{constructor(t,e,i=!1,a){if(this.name=t,this.owner=e,this.unique=i,this.slow=0,a instanceof m?(this.action=a,this.src=a.owner):a instanceof q?this.src=a:this.src=e,i&&this.owner.buffNamed(t))throw Error(`Buff ${t} is unique`);this.owner.buffs.push(this)}get remainingTime(){return 1/0}set remainingTime(t){}get duration(){return 1/0}set duration(t){}get isActive(){return this.owner.buffs.includes(this)}fade(){let t=this.owner.buffs.indexOf(this);-1!==t&&this.owner.buffs.splice(t,1)}}class G extends I{constructor(t,e,i,a=!1,s){super(t,e,a,s),this.promise=this.owner.sim.waitFor(i),this.promise.then(()=>this.fade())}get remainingTime(){return this.promise.remainingTime}set remainingTime(t){this.promise.remainingTime=t}get duration(){return this.promise.waitFor}set duration(t){this.promise.waitFor=t}fade(){this.promise.resolve(!0),super.fade()}}class O extends G{constructor(t,e,i,a,s){super(t,e,i,!0,a),this.slow=s}}class L extends G{constructor(t,e,i,a,s){super(t,e,i,a,s),this.stackDuration=i,this._stacks=1,this.maxStacks=1,this.onGainStats()}stack(){this.isMaxStacks||(this.onLoseStats(),this._stacks=Math.min(this.maxStacks,this._stacks+1),this.onGainStats()),this.remainingTime=this.stackDuration}get stacks(){return this._stacks}get isMaxStacks(){return this._stacks>=this.maxStacks}onLoseStats(){}onGainStats(){}fade(){this.isActive&&(this.onLoseStats(),super.fade())}}class P extends G{constructor(t){if(super(N.ename,t.owner,t.level?5e3:0,!0,t),!this.action.level)return;this.removeOnHit=t.owner.action.attack.onHitUnit((e,a)=>{e.interaction.takeDamage({value:N.damage(t.owner,this.action.level)*a,src:this.owner,type:i.TRUE})})}fade(){super.fade(),this.removeOnHit?.()}}class j extends w{async onFinishCast(){new P(this.action)}}class N extends m{static{this.ename="Wuju Style"}static damage(t,e){return e<=0?0:25+5*e+.3*t.bonusAd}constructor(t){super(N.ename,t),this.maxLevel=5,this.minLevel=1,this.isCancelableByUser=!1,this.isCooldownFinishedOnInterrupt=!1,this.isUltimate=!1}get castTime(){return 0}get cooldownTime(){return 0===this.level?0:14e3*this.owner.abilityHasteModifier*this.abilityHasteModifier}async cast(){return new j(this).init()}}class Y extends G{constructor(t){if(super($.rname,t.owner,t.level?$.duration:0,!0,t),!t.level)return;this.removeTakedown=t.owner.interaction.onTakedown((e,i)=>{i+$.assistDuration>=t.owner.sim.time&&(this.duration+=$.duration)}),t.owner.mMs*=$.bonusMMs(this.action.level),t.owner.bonusAs.value+=$.bonusAs(this.action.level)}fade(){this.isActive&&(super.fade(),this.removeTakedown?.(),this.owner.mMs/=$.bonusMMs(this.action.level),this.owner.bonusAs.value-=$.bonusAs(this.action.level))}}class W extends w{async onFinishCast(){let t=this.action.owner.buffNamed($.rname);t?t.remainingTime=Math.max(t.remainingTime,7e3):new Y(this.action)}}class $ extends m{static{this.rname="Highlander"}static{this.duration=7e3}static{this.assistDuration=1e4}static bonusAs(t){return 15+10*t}static bonusMMs(t){return 1+(25+10*t)/100}constructor(t){super($.rname,t),this.maxLevel=3,this.minLevel=1,this.isCancelableByUser=!1,this.isCooldownFinishedOnInterrupt=!1,this.isUltimate=!0}get manaCost(){return this.level<=0?0:100}get castTime(){return 0}get cooldownTime(){return 0===this.level?0:85e3*this.owner.abilityHasteModifier*this.abilityHasteModifier}async cast(){return await new W(this).init()}}class z extends w{async onStartCast(){this.action.owner.action.attack.finishCooldown();let t=this.action.owner.interaction.percentDamageReduction(t=>{t.type!==i.TRUE&&(e<500?t.value*=.1:t.value*=(100-K.dr(this.action.level))/100)}),e=0;for(;e<=this.action.castTime;e+=500)if(await Promise.any([this.wait(),this.action.owner.sim.waitFor(500)])){if(this.action.owner.interaction.takeHeal({src:this.action.owner,value:K.tickHeal(this.action.level,this.action.owner)}),this.action.owner.mana>=this.action.channelManaCost)this.action.owner.mana-=this.action.channelManaCost;else{this.interrupt();break}}else break;t()}}class K extends m{static{this.wname="Meditate"}static dr(t){return t<=0?0:42.5+2.5*t}static tickHeal(t,e){return t<=0?0:(5+10*t)*(2-e.health/e.maxHealth)}constructor(t){super(K.wname,t),this.maxLevel=5,this.minLevel=1,this.isCancelableByUser=!0,this.isCooldownFinishedOnInterrupt=!1,this.isUltimate=!0}get manaCost(){return this.level<=0?0:40}get channelManaCost(){return 0===this.level?0:.06*this.owner.maxMana}get castTime(){return 0===this.level?0:4e3}get cooldownTime(){return 0===this.level?0:9e3*this.owner.abilityHasteModifier*this.abilityHasteModifier}async cast(){return await new z(this).init()}}class Q extends I{constructor(t,e,i){super(X.qname,t,!1,e.owner),this.random=i,this.level=e.level,this.damage=X.markDamage(this.src,this.level),this.critDamage=X.markCritDamage(this.src,this.level)}fade(){if(this.isActive){if(this.owner.targetable.value){let t=this.src.crit>=100*this.random(),e=t?this.damage+this.critDamage:this.damage,a=this.owner.buffsNamed(X.qname).length>1?.25:1;this.owner.interaction.takeDamage({src:this.src,type:i.PHYSIC,value:e*a,isCrit:t}),this.src.action.attack.procOnHitUnit(this.owner,.75*a)}super.fade()}}}class J extends f{constructor(t,e,i){super(t,e),this.random=i}async onStartCast(){this.action.owner.targetable.value=!1;let t=[];for(let e=0;e<4*X.markTime;e+=X.markTime)if(await Promise.any([this.wait(),this.action.owner.sim.waitFor(X.markTime)])){let e=this.option;if(e.buffNamed(X.qname)){let t=this.action.owner.sim.units.filter(t=>t!==e&&this.action.targetable(t)&&!t.buffNamed(X.qname))[0];t&&(e=t)}t.push(new Q(e,this.action,this.random))}else break;for(let e of(this.action.owner.pos<=this.option.pos?this.action.owner.pos=this.option.pos-X.appearDistance:this.action.owner.pos=this.option.pos+X.appearDistance,this.action.owner.targetable.value=!0,!this.action.owner.dead.value&&this.option.targetable.value&&await this.action.owner.sim.waitFor(X.markProcTime),t))e.fade()}}class X extends d{static{this.qname="Alpha Strike"}static markDamage(t,e){return 30*e+.5*t.ad}static markCritDamage(t,e){return(10.5*e+.175*t.ad)*(1+t.bonusCritDamage/100)}static{this.markTime=231}static{this.markProcTime=164}static{this.appearDistance=75}constructor(t){super(X.qname,t),this.maxLevel=5,this.minLevel=1,this.isCancelableByUser=!1,this.isCooldownFinishedOnInterrupt=!1,this.isUltimate=!1,this.random=n(x)(),t.action.attack.onCast(()=>this.remainingCooldown-=1e3*t.abilityHasteModifier)}get maxRange(){return 600}get manaCost(){return 0===this.level?0:45+5*this.level}get castTime(){return 0===this.level?0:4*X.markTime+X.markProcTime+1}get cooldownTime(){return 0===this.level?0:(20500-500*this.level)*this.owner.abilityHasteModifier*this.abilityHasteModifier}async cast(t){return await new J(this,t,this.random).init()}}class Z{static{this.pname="Double Strike"}static{this.duration=4e3}constructor(t){this.owner=t,this.disabled=!1}init(){return this.owner.action.attack.onCast(t=>{if(this.disabled)return;let e=this.buff;e?(e.stack(),e.isMaxStacks&&(e.fade(),t.interaction.takeDamage({value:.5*this.owner.ad,src:this.owner,type:i.PHYSIC}),this.owner.action.attack.procOnHitUnit(t),this.owner.action.attack.procOnCast(t))):new V(this.owner)}),this}get buff(){return this.owner.buffNamed(Z.pname)}}class V extends L{constructor(t){super(Z.pname,t,Z.duration,!0),this.maxStacks=3}}class tt extends _{init(){return super.init(),this.e=new N(this.owner),this.r=new $(this.owner),this.passive=new Z(this.owner).init(),this.w=new K(this.owner),this.q=new X(this.owner),this}}class te extends F{constructor(){super("Master Yi"),this.isMelee=!0,this.stats=R,this.levelUpPriority=["R","Q","E","W"]}levelUp(){this.levelUpAnyChampion(this.action.q,this.action.w,this.action.e,this.action.r)}async killDummy(t){if(!(this.distance(t)>this.action.attack.maxRange&&await this.action.q.cast(t))&&!await this.action.r.cast()){if(!(this.action.attack.currentCast&&await this.action.attack.currentCast.wait()))if(this.action.attack.castable(t)&&await this.action.e.cast()&&await this.action.attack.cast(t))return;else if(!this.action.attack.currentCast&&this.action.attack.isCooldown&&this.action.attack.targetable(t)&&this.action.w.castable())this.action.w.cast(),this.currentCast.value?.action===this.action.w&&await this.currentCast.value.cancel(),await this.action.attack.cast(t);else{if(this.action.attack.isCooldown&&await this.action.move.closeTo(t)||this.action.attack.castable(t)&&await this.action.attack.cast(t))return;await this.action.move.closeTo(t)}}}init(t,e=this.team,i=this.level){return super.init(t,e,i),this.action=new tt(this),this.action.init(),this}}const ti={baseMs:345,baseAs:.625,asGrowth:2.25,baseHealth:610,healthGrowth:90,baseMana:280,manaGrowth:42,attackAnimation:.19359,attackRange:125,baseAd:61,adGrowth:3,baseArmor:29,armorGrowth:4.2};class ta extends F{constructor(){super("Nunu"),this.isMelee=!0,this.stats=ti,this.levelUpPriority=["R","Q","E","W"]}levelUp(){}init(t){return super.init(t),this.action=new _(this),this.action.init(),this}}const ts=[te,ta],tn=Symbol("boots"),to={unique:!0,type:"item",name:"Boots",bonusMs:25,uniqueGroup:tn},tr=[to,{unique:!0,type:"finishedItem",name:"Berserker's Greaves",bonusMs:45,bonusAs:35,uniqueGroup:tn}];(e=a||(a={}))[e.SimulationStopped=0]="SimulationStopped",e[e.UnitDeath=1]="UnitDeath",e[e.RemoveEventListener=2]="RemoveEventListener",e[e.Canceled=3]="Canceled",e[e.TargetDeath=4]="TargetDeath";class tc extends Promise{constructor(t=(t,e)=>{}){let e;super((i,a)=>(e=i,t(i,a))),this._resolve=e}get result(){return this._result}resolve(t){this._result=t,this._resolve(t)}}class th extends tc{constructor(t=(t,e)=>{},e,i,a){if(super((e,i)=>t(e,i)),this._sim=e,this._waitFor=i,this._reinsert=a,void 0===e)return;this.timeStart=e.time}get time(){return this.timeStart+this._waitFor}get remainingTime(){return Math.max(0,this.time-this._sim.time)}set remainingTime(t){this.waitFor+=t-this.remainingTime}get waitFor(){return this._waitFor}set waitFor(t){let e=this._waitFor;this._waitFor=t,this._reinsert(e)}}"undefined"!=typeof window&&c("jGbML");class tl{get time(){return this._time}insertIntoWheel(t){let e=0,i=this.wheel.length-1;for(;e<=i;){let a=e+i>>1;this.wheel[a].time>t.time?e=a+1:i=a-1}this.wheel.splice(e,0,t)}reinsertIntoWheel(t,e){let i=0,a=this.wheel.length-1;for(;i<=a;){let s=i+a>>1;if(this.wheel[s]===t)break;this.wheel[s].time>e?i=s+1:a=s-1}this.wheel[i]===t&&(this.wheel.splice(i,1),this.insertIntoWheel(t))}waitFor(t){let e=new th(void 0,this,t,t=>this.reinsertIntoWheel(e,t));return this.insertIntoWheel(e),e}waitForResolve(){return this.waitFor(0)}get isStopped(){return this._isStopped}stop(){for(let t of(this._isStopped=!0,this.wheel))t.resolve(!1)}consume(){setImmediate(()=>{let t=this.wheel.pop();this._time=t.time,t.resolve(!0),!this.isStopped&&this.wheel.length&&this.consume()})}start(t){return this.waitFor(t).then(()=>{this.stop()}),this.consume(),this}constructor(){this.tickTime=33,this._time=0,this.wheel=[],this._isStopped=!1,this.units=[]}}class tu{constructor(){this.maxTime=18e4,this.undying1=!1,this.undying2=!1,this.sustain1=!1,this.sustain2=!1}}const tm=async(t,e=new tu)=>{let a=new tl,s=t(a);if(!s)return;let[n,o,r,c]=s;a.start(e.maxTime);let h=0,l=0,u=0,m=0;r.interaction.onTakeDamage(t=>{h+=t.value,m+=1,t.isCrit&&(u+=1)}),n.interaction.onTakeDamage(t=>{l+=t.value,m+=1,t.isCrit&&(u+=1)}),e.undying1&&n.interaction.finalDamageReduction(t=>{t.value>=n.health&&(n.health=n.maxHealth),t.value>=n.health&&(t.value=n.health-1)}),e.undying2&&r.interaction.finalDamageReduction(t=>{t.value>=r.health&&(r.health=r.maxHealth),t.value>=r.health&&(t.value=r.health-1)});let d=async()=>{if(!e.sustain1)return;let t=10+n.calcStatGrowth(1),s=1;do await a.waitFor(100),n.interaction.takeDamage({src:U,type:i.PHYSIC,value:t*s*.45}),n.interaction.takeDamage({src:U,type:i.MAGIC,value:t*s*.45}),n.interaction.takeDamage({src:U,type:i.TRUE,value:t*s*.1}),s+=.01;while(!n.dead.value&&!r.dead.value&&!a.isStopped)},p=async()=>{if(!e.sustain2)return;let t=10+r.calcStatGrowth(1),s=1;do await a.waitFor(100),r.interaction.takeDamage({src:U,type:i.PHYSIC,value:t*s*.45}),r.interaction.takeDamage({src:U,type:i.MAGIC,value:t*s*.45}),r.interaction.takeDamage({src:U,type:i.TRUE,value:t*s*.1}),s+=.01;while(!n.dead.value&&!r.dead.value&&!a.isStopped)},w=async()=>{for(;!n.dead.value&&!r.dead.value&&!a.isStopped;){let t=a.time;await o(n,r),a.time===t&&await a.waitFor(2*a.tickTime)}},f=async()=>{for(;!n.dead.value&&!r.dead.value&&!a.isStopped;){let t=a.time;await c(r,n),a.time===t&&await a.waitFor(2*a.tickTime)}};await Promise.all([w(),f(),d(),p()]);let v=!n.dead.value&&r.dead.value?n:n.dead.value&&!r.dead.value?r:void 0;return{ttk:a.time,dps1:h/(a.time/1e3),damage1:h,dps2:l/(a.time/1e3),damage2:l,distance:Math.abs(n.pos-r.pos),winner:v,champion1:n,champion2:r,crits:u/m}},td=async(t,e=new tu)=>{let i=[],a=await tm(t,e);if(a){if(i.push(a),a.crits>=.01)for(let a=0;a<10;a+=1){let a=await tm(t,e);a&&i.push(a)}let s=0,n=0,o={ttk:0,dps1:0,damage1:0,dps2:0,damage2:0,distance:0,champion1:a.champion1,champion2:a.champion2,crits:0};for(let t of i)o.ttk+=t.ttk,o.dps1+=t.dps1,o.damage1+=t.damage1,o.dps2+=t.dps2,o.damage2+=t.damage2,o.distance+=t.distance,o.crits+=t.crits,t.winner===t.champion1?s+=1:t.winner===t.champion2&&(n+=1);return s>n?o.winner=a.champion1:n>s&&(o.winner=a.champion2),o.ttk/=i.length,o.dps1/=i.length,o.damage1/=i.length,o.dps2/=i.length,o.damage2/=i.length,o.distance/=i.length,o.crits/=i.length,o}};class tp extends tu{constructor(...t){super(...t),this.dummyRunsAway=!1}}const tw=(t,e=new tp)=>td(i=>{let a=t(i);if(!a)return;let s=new ta;return a.appliedEquips.some(t=>t.uniqueGroup===tn)&&s.applyEquip(to),s.level=a.level,s.init(i),[a,(t,e)=>t.killDummy(e),s,(t,i)=>{if(e.dummyRunsAway)return t.runAwayFromEnemyAsDummy(i)}]},e);class tf extends G{constructor(t){super(tv.name,t,8e3,!0),t.mMs*=1.15,t.bonusAs.value+=35}fade(){this.isActive&&(this.owner.mMs/=1.15,this.owner.bonusAs.value-=35,super.fade())}}const tv={unique:!0,name:"Experimental Hexplate",type:"finishedItem",bonusAd:55,bonusAs:25,maxHealth:300,apply:t=>{let e=t.action.r;if(e&&e.maxLevel!==t.action?.q.maxLevel){e.abilityHaste+=30;let i=-1/0;e.onCast(()=>{i+3e4<=t.sim.time&&(i=t.sim.time,new tf(t))})}},test:()=>{test("Experimental Hexplate",async()=>{let t=new tl().start(5e5),e=new te().init(t);e.action.r.level=1;let i=e.action.r.cooldownTime;expect(i).toBeGreaterThan(2e4),expect(e.applyEquip(tv)).toBe(!0),expect(e.action.r.cooldownTime).toBeLessThan(i),expect(await e.action.r.cast()),expect(e.mMs).toBeGreaterThan($.bonusMMs(1)),expect(e.bonusAs.value).toBeGreaterThan($.bonusAs(1));let a=e.mMs,s=e.bonusAs.value;e.action.r.finishCooldown(),expect(await e.action.r.cast()),expect(e.mMs).toBe(a),expect(e.bonusAs.value).toBe(s),await t.waitFor(1e4),expect(e.mMs).toBe(1),expect(e.bonusAs.value).toBe(25)})}},tx=[tv],tg=(t,e)=>t.isMelee?.12*e.health:.09*e.health,tk={unique:!0,type:"finishedItem",name:"Blade of the Ruined King",bonusAd:40,bonusAs:25,lifesteal:8,apply:t=>{let e=-1/0;t.action.attack.onHitUnit((a,s)=>{let n=a.interaction.takeDamage({src:t,type:i.PHYSIC,value:tg(t,a)*s}).value;t.lifesteal>0&&t.interaction.takeHeal({value:t.lifesteal/100*n,src:t}),e+15e3<=t.sim.time&&(e=t.sim.time,new O(tk.name,a,1e3,t,30))})},test:()=>{test("botrk",async()=>{let t=new tl().start(5e5),e=new te().init(t),a=new te().init(t);a.armor=0,a.health=1e3,expect(e.applyEquip(tk)).toBe(!0);let s=0;a.interaction.onTakeDamage(t=>{t.src===e&&t.type===i.PHYSIC&&120===t.value&&(s+=1)}),expect(await e.action.attack.cast(a)).toBe(!0),expect(s).toBe(1),expect(a.slow).toBe(30),expect(a.ms).toBeLessThan(300),await t.waitFor(1001),expect(a.slow).toBe(0),expect(a.ms).toBeGreaterThan(300),expect(await e.action.attack.cast(a)).toBe(!0),expect(a.slow).toBe(0),expect(a.ms).toBeGreaterThan(300),await t.waitFor(13999-2*e.action.attack.castTime),expect(await e.action.attack.cast(a)).toBe(!0),expect(a.slow).toBe(30),expect(a.ms).toBeLessThan(300)})}},tb=t=>{let e=15;if(t.level>=9)for(let i=9;i<=Math.min(14,t.level);i+=1)e+=10;if(t.level>=15)for(let i=15;i<=Math.min(18,t.level);i+=1)e+=1.25;return e},ty={unique:!0,type:"finishedItem",name:"Wit's End",bonusAs:55,mr:50,apply:t=>{t.action.attack.onHitUnit((e,a)=>{e.interaction.takeDamage({src:t,type:i.MAGIC,value:tb(t)*a})})},test:()=>{test("Witsend",async()=>{let t=new tl().start(5e5),e=new te().init(t);expect(e.applyEquip(ty)).toBe(!0);let a=new te().init(t);expect(tb(e)).toBe(15),e.level=6,expect(tb(e)).toBe(15),e.level=12,expect(tb(e)).toBe(55),e.level=17,expect(tb(e)).toBe(78.75);let s=0;a.interaction.onTakeDamage(t=>{t.src===e&&t.type===i.MAGIC&&t.value>=50&&(s+=1)}),expect(await e.action.attack.cast(a)).toBe(!0),expect(s).toBe(1)})}};class tC extends L{static{this.duration=3e3}static{this.phantomDuration=3e3}static{this.maxStacks=4}static{this.bonusAsPerStack=8}constructor(t){super(tT.name,t,tC.duration,!0),this.maxStacks=tC.maxStacks}onLoseStats(){this.owner.bonusAs.value-=this.stacks*tC.bonusAsPerStack}onGainStats(){this.owner.bonusAs.value+=this.stacks*tC.bonusAsPerStack}}class tM extends L{static{this.pname=tC.name+"Phantom"}static{this.duration=6e3}static{this.pause=150}constructor(t){super(tM.pname,t,tM.duration,!0),this.maxStacks=2}}const tT={name:"Guinsoo's Rageblade",unique:!0,type:"finishedItem",bonusAd:30,bonusAs:25,apply:t=>{t.action.attack.onHitUnit((e,a)=>e.interaction.takeDamage({src:t,type:i.MAGIC,value:30*a})),t.action.attack.onCast(e=>{let i=t.buffNamed(tT.name);if(i instanceof tC){if(i.isMaxStacks){let i=t.buffNamed(tM.pname);i instanceof tM?i.isMaxStacks?(t.sim.waitFor(tM.pause).then(()=>{!t.dead.value&&e.targetable.value&&t.action.attack.procOnHitUnit(e,1)}),i.fade()):i.stack():new tM(t)}i.stack()}else new tC(t)})},test:()=>{test("guinso basic",async()=>{let t=new tl().start(5e5),e=new te().init(t);expect(e.applyEquip(tT)).toBe(!0);let a=new te().init(t);a.mr=0;let s=0;a.interaction.onTakeDamage(t=>{t.src===e&&t.type===i.MAGIC&&30==t.value&&(s+=1)}),expect(await e.action.attack.cast(a)).toBe(!0),expect(s).toBe(1)}),test("guinso",async()=>{let t=new tl().start(5e5),e=new te().init(t);e.action.passive.disabled=!0,expect(e.applyEquip(tT)).toBe(!0);let i=new te().init(t);i.health=1e4;let a=0;e.action.attack.onHitUnit(()=>a+=1),expect(e.bonusAs.value).toBe(25),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(1),expect(e.bonusAs.value).toBe(33),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(2),expect(e.bonusAs.value).toBe(41),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(3),expect(e.bonusAs.value).toBe(49),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(4),expect(e.bonusAs.value).toBe(57),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(5),expect(e.bonusAs.value).toBe(57),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(6),expect(e.bonusAs.value).toBe(57),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(7),expect(e.bonusAs.value).toBe(57),await t.waitFor(151),expect(a).toBe(8),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(9),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(10),expect(await e.action.attack.cast(i)).toBe(!0),expect(a).toBe(11),await t.waitFor(151),expect(a).toBe(12),await t.waitFor(tM.duration+1),expect(e.buffNamed(tM.pname)).toBeUndefined(),await t.waitFor(tC.duration-tM.duration),expect(e.bonusAs.value).toBe(25),expect(e.buffNamed(tT.name)).toBeUndefined()})}};class tA extends L{static kname(){return tS.name+" debuff"}static{this.duration=6e3}static{this.maxStacks=2}static damage(t,e){let i=35;if(t.level>=9)for(let t=9;t<=18;t+=1)i+=5;return i+=.65*t.ad,i*=1+.5*(e.buffNamed(tA.kname())?.stacks||0)}constructor(t,e){super(tA.kname(),t,tA.duration,!0,e),this.maxStacks=tA.maxStacks}}class tB extends L{static{this.duration=3e3}static{this.maxStacks=3}constructor(t){super(tS.name,t,tB.duration,!0),this.maxStacks=tB.maxStacks}}const tS={unique:!0,type:"finishedItem",name:"Kraken Slayer",bonusAd:40,bonusAs:35,crit:20,apply:t=>{t.action.attack.onHitUnit(e=>{let i=t.buffNamed(tS.name);i instanceof tB?i.stack():new tB(t)}),t.action.attack.onCast(e=>{let a=t.buffNamed(tS.name);if(a instanceof tB){if(!a.isMaxStacks)return;e.interaction.takeDamage({src:t,type:i.PHYSIC,value:tA.damage(t,e)});let s=e.buffNamed(tA.kname());s instanceof tA?s.stack():new tA(e,t),a.fade()}})},test:()=>{test("kraken basic",async()=>{let t=new tl().start(5e5),e=new te().init(t);e.action.passive.disabled=!0,expect(e.applyEquip(tS)).toBe(!0);let a=new te().init(t);a.armor=0,a.health=1e4;let s=0;a.interaction.onTakeDamage(t=>{t.type===i.PHYSIC&&t.value>0&&(s+=1)}),expect(await e.action.attack.cast(a)).toBe(!0),expect(await e.action.attack.cast(a)).toBe(!0),expect(s).toBe(2),expect(await e.action.attack.cast(a)).toBe(!0),expect(s).toBe(4)}),test("kraken advanced",async()=>{let t=new tl().start(5e5),e=new te().init(t);e.action.passive.disabled=!0,expect(e.applyEquip(tS)).toBe(!0),e.crit=0;let a=new te().init(t);a.armor=0,a.health=1e4;let s={};a.interaction.onTakeDamage(t=>{t.type===i.PHYSIC&&t.value>0&&(s[t.value.toFixed(2)]=!0)}),expect(await e.action.attack.cast(a)).toBe(!0),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(1),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(2),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(2),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(2),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(3),expect(await e.action.attack.cast(a)).toBe(!0),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(3),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(4),expect(await e.action.attack.cast(a)).toBe(!0),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(4),expect(await e.action.attack.cast(a)).toBe(!0),expect(Object.values(s).length).toBe(4)})}},tD=[...tr,tk,ty,tT,tS,...tx];class t_ extends tp{equipToString(t){return t.concat().sort((t,e)=>t.name.localeCompare(e.name)).reduce((t,e)=>t+" "+e.name,"")}equipAddToSimulated(t){this.simulatedItems[this.equipToString(t)]=!0}equipExists(t){return!!this.simulatedItems[this.equipToString(t)]}championExists(t){return this.equipExists(t.appliedEquips.filter(t=>"finishedItem"===t.type||"item"===t.type))}addChampion(t){return this.equipAddToSimulated(t.appliedEquips.filter(t=>"finishedItem"===t.type||"item"===t.type))}resetSimulatedItems(){this.simulatedItems={}}constructor(...t){super(...t),this.itemsToLook=tD,this.simulatedItems={}}}const tH=async(t,e=new t_)=>{let i=[];for(let a of e.itemsToLook){let s=await tw(i=>{let s=t(i);if(s&&s.applyEquip(a)&&!e.championExists(s))return s},e);s&&(e.addChampion(s.champion1),i.push({item:a,result:s}),e.sustain1?i.sort((t,e)=>e.result.damage1-t.result.damage1):i.sort((t,e)=>t.result.ttk-e.result.ttk))}return i},tE=async(t,e,i=new t_)=>{let a=[];for(let s of(await tH(t,i)))if(e>1){let n=await tE(e=>{let i=t(e);if(i&&i.applyEquip(s.item))return i},e-1,i);if(0===n.length)a.push({items:[s.item],result:s.result});else for(let t of n)a.push({items:[s.item,...t.items],result:t.result})}else a.push({items:[s.item],result:s.result});return i.sustain1?a.sort((t,e)=>e.result.damage1-t.result.damage1):a.sort((t,e)=>t.result.ttk-e.result.ttk),a};var tq=c("hJ3nf");const tU=async(t,e)=>{if("undefined"!=typeof window)return await new Promise(i=>{let a=document.querySelector("#question");a&&(a.textContent=t);let s=document.querySelector("input");if(s){let t=a=>{"Enter"===a.key&&(s.removeEventListener("keydown",t),i(e(s.value)),s.value="")};s.addEventListener("keydown",t)}});{let i=(await Promise.resolve(c("kjyEk"))).createInterface(tq.stdin,tq.stdout),a=e(await i.question(t+"\n"));return i.close(),a}},tF=async()=>{let t=ts.reduce((t,e,i)=>t+`${i} ${new e().name}\r
`,"")+"Pick a champion (number or string) Master Yi default",e=await tU(t,t=>ts[t]||ts.find(e=>new e().name.toLowerCase()===t.toLowerCase())||te),i=await tU("Count of items (1-6) 1 default",t=>{let e=parseInt(t);return isNaN(e)&&(e=1),Math.max(1,Math.min(6,Math.floor(e)))}),a=new t_,s=await tU("Select champion level (1-18) 9 default",t=>{let e=parseInt(t);return isNaN(e)&&(e=9),Math.max(1,Math.min(18,Math.floor(e)))});return a.sustain1=await tU("Should test sustain (y/n) y default",t=>"n"!==t[0]),a.sustain1&&(a.undying2=!0),a.dummyRunsAway=await tU("Should dummy run away (y/n) n default",t=>"y"===t[0]),{level:s,Champion:e,itemsCount:i,withBoots:!1,config:a}},tR=t=>{"undefined"!=typeof window?document.body.innerText=t:console.log(t)};(async()=>{let t=await tF(),e=await tE(e=>{let i=new t.Champion;return i.level=t.level,i.init(e),i.levelUp(),i},t.itemsCount,t.config),i="";if(e.length>0)for(let a=0;a<10&&a<e.length;a+=1){for(let t in e[a].items)i+=`item${Number(t)+1}: '${e[a].items[t].name}' `;t.config.sustain1?i+=`damage: ${e[a].result.damage1.toFixed(2)} sustained: ${(e[a].result.ttk/1e3).toFixed(2)}\r
`:i+=`timetokill: ${(e[a].result.ttk/1e3).toFixed(2)} dps: ${e[a].result.dps1.toFixed(2)}\r
`}else i+=`Simulation failed, no items simulated\r
`;tR(i)})();</script> </body></html>